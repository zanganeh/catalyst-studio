# Story 7.0: Environment Setup & Credential Management

## Status
Ready for Review

## Story
**As a** developer,  
**I want** clear documentation and setup process for all required credentials and environment configuration,  
**so that** development can begin without blockers.

## Acceptance Criteria
1. Comprehensive guide for obtaining Optimizely API credentials created
2. .env.template file with all required environment variables
3. Secure credential storage process documented
4. Local development setup guide with step-by-step instructions
5. Fallback configuration for development without live API access
6. Troubleshooting guide for common credential issues

## Tasks / Subtasks
- [x] Git Setup (REQUIRED FIRST TASK)
  - [x] Checkout and update main: `git checkout main && git pull origin main`
  - [x] Create feature branch: `git checkout -b feature/epic7-environment-setup`

- [x] Create Optimizely API Documentation (AC: 1, 3)
  - [x] Create `docs/setup/optimizely-credentials.md` file
  - [x] Document Optimizely account setup process
  - [x] Document required API scopes and permissions
  - [x] Include screenshots or detailed navigation steps
  - [x] Document API key generation process in Optimizely admin panel
  - [x] Specify Project ID retrieval process
  - [x] Add credential rotation process documentation

- [x] Create Environment Configuration Template (AC: 2, 5)
  - [x] Create `.env.template` file in project root if not exists
  - [x] Update `.env.template` with all Epic 7 required variables:
    - [x] Add CMS Provider Configuration section
    - [x] Add Optimizely Configuration section
    - [x] Add Feature Flags section
    - [x] Add Development Settings section
    - [x] Add Transformation Settings section
  - [x] Include clear comments explaining each variable
  - [x] Add example values where appropriate (non-sensitive)
  - [x] Document mock provider settings for offline development

- [x] Create Local Development Setup Guide (AC: 4)
  - [x] Create `docs/setup/local-development.md` file
  - [x] Write step-by-step setup instructions including:
    - [x] Prerequisites (Node.js version, npm/yarn, etc.)
    - [x] Repository cloning instructions
    - [x] Dependencies installation
    - [x] Environment variable setup from template
    - [x] Database setup if required
    - [x] Initial data seeding process
  - [x] Add verification steps to confirm setup is working
  - [x] Include commands for running development server

- [x] Configure Mock Provider Support (AC: 5)
  - [x] Create `mock-data/` directory structure
  - [x] Create `mock-data/optimizely/` subdirectory
  - [x] Create sample mock data files for testing:
    - [x] `mock-data/optimizely/content-types.json`
    - [x] `mock-data/optimizely/pages.json` 
    - [x] `mock-data/optimizely/blocks.json`
  - [x] Document how to enable mock mode in `.env.template`
  - [x] Add instructions for using mock data in development

- [x] Create Troubleshooting Guide (AC: 6)
  - [x] Create `docs/setup/troubleshooting.md` file
  - [x] Document common credential issues and solutions:
    - [x] Invalid API key errors
    - [x] Permission/scope errors
    - [x] Network/firewall issues
    - [x] CORS problems
    - [x] Rate limiting issues
  - [x] Add debugging tips for API connection issues
  - [x] Include verification commands/scripts
  - [x] Document how to check if credentials are working

- [x] Update Main README (AC: 4)
  - [x] Add "Getting Started" section pointing to setup docs
  - [x] Add links to credential setup guide
  - [x] Add environment setup requirements
  - [x] Include Epic 7 feature flags documentation

- [x] Testing and Validation
  - [x] Test complete setup process on a clean environment
  - [x] Verify mock mode works without real credentials
  - [x] Ensure all documented steps are accurate
  - [x] Test troubleshooting solutions

- [ ] Submit PR (REQUIRED FINAL TASK)
  - [ ] Push branch: `git push -u origin feature/epic7-environment-setup`
  - [ ] Create PR from feature branch → main branch
  - [ ] PR Title: "Epic 7 Story 7.0: Environment Setup & Credential Management"
  - [ ] Link PR to story in description

## Dev Notes

### GitFlow Workflow
Branch Name: feature/epic7-environment-setup
Base Branch: main
PR Target: main

Git Commands:
1. Setup: `git checkout main && git pull origin main`
2. Create: `git checkout -b feature/epic7-environment-setup`
3. Commit: Use conventional commits (feat:, fix:, docs:, etc.)
4. Push: `git push -u origin feature/epic7-environment-setup`
5. PR: Create PR to main branch with title "Epic 7 Story 7.0: Environment Setup & Credential Management"

### Project Structure Context
**Current CMS Integration Location**: 
- Existing Optimizely integration found in `lib/sync/adapters/optimizely-api-client.ts` [Source: project scan]
- Test files in `lib/sync/adapters/__tests__/` [Source: project scan]
- This story focuses on documentation and setup, not modifying existing code

**New Directory Structure for Epic 7**:
According to the architecture document, the provider pattern will eventually use:
```
lib/providers/                    # Future location for provider architecture
  optimizely/                      # Optimizely provider module
  common/                          # Shared interfaces
```
[Source: epic7-architecture.md#New File Organization]

**Environment Variables Required** (from PRD):
```bash
# CMS Provider Configuration
PROVIDER_TYPE=optimizely # Options: optimizely, contentful, strapi, mock

# Optimizely Configuration  
OPTIMIZELY_API_KEY=
OPTIMIZELY_PROJECT_ID=
OPTIMIZELY_API_URL=https://api.optimizely.com/v2

# Feature Flags
ENABLE_PROVIDER_PATTERN=false # Set to true to use new provider pattern
ENABLE_AI_GENERATION=false # Set to true to enable AI type generation

# Development Settings
USE_MOCK_PROVIDER=false # Set to true for offline development
MOCK_DATA_PATH=./mock-data
LOG_LEVEL=info # Options: debug, info, warn, error

# Transformation Settings
MIN_CONFIDENCE_SCORE=70 # Minimum confidence for auto-apply
MAX_TRANSFORMATION_DEPTH=10 # Maximum nesting depth
```
[Source: epic7-prd.md#7.2 Environment Configuration Template]

### Optimizely API Details
**API Credential Requirements**:
1. Log into Optimizely CMS admin panel
2. Navigate to Settings → API Keys
3. Create new API key with following scopes:
   - Content Type Read/Write
   - Content Read/Write  
   - Media Read/Write
4. Copy the API key and Project ID
[Source: epic7-prd.md#7.1 Optimizely API Credentials]

### Security Requirements
- Never commit .env files to version control
- Use environment-specific files (.env.local, .env.production)
- Rotate API keys regularly
- Use read-only keys for development when possible
- Implement key encryption for production environments
[Source: epic7-prd.md#7.3 Security Best Practices]

### Testing Standards
- No unit tests required for this documentation story
- Manual testing: Verify all setup steps work on clean environment
- Validation: Ensure mock mode functions without real credentials
- All documentation must be accurate and tested

### Important Notes
- This is the first story of Epic 7 - focuses entirely on documentation and setup
- No code changes to existing Optimizely integration in this story
- Sets foundation for subsequent provider pattern implementation
- Mock data structure should align with future universal type system

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-01-19 | 1.0 | Initial story creation | Bob (Scrum Master) |

## Dev Agent Record

### Agent Model Used
claude-opus-4-1-20250805 (James - Full Stack Developer)

### Debug Log References
- Git branch creation successful
- All documentation files created without errors
- Mock data structure implemented
- Environment template verified (already existed with Epic 7 config)

### Completion Notes List
- Successfully created comprehensive documentation for Epic 7 environment setup
- Implemented three-tier documentation approach: credentials, development, troubleshooting
- Created realistic mock data for Optimizely provider testing
- Updated main README with Epic 7 quick start section
- All acceptance criteria met

### File List
**New Files Created:**
- docs/setup/optimizely-credentials.md
- docs/setup/local-development.md
- docs/setup/troubleshooting.md
- mock-data/optimizely/content-types.json
- mock-data/optimizely/pages.json
- mock-data/optimizely/blocks.json

**Modified Files:**
- README.md (added Epic 7 setup section)
- .env.template (verified, already had Epic 7 config)

## QA Results
[To be filled by QA Agent]