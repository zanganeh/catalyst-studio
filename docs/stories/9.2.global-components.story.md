# Story 9.2: Global Components Implementation

## Status
Ready for Review

## Story
**As a** developer,
**I want** to create the four global components (hero, header, footer, CTA) with basic schemas and validation,
**so that** pages in the sitemap builder can have components assigned to them.

## Acceptance Criteria
1. Hero component is created with basic schema and default values
2. Header component is created with basic schema and default values
3. Footer component is created with basic schema and default values
4. CTA component is created with basic schema and default values
5. All components are placed in the correct premium location (/lib/premium/components/globals/)
6. Each component has a schema.ts file with metadata and validation
7. Each component has default props defined
8. Components use TypeScript for type safety
9. Basic validation for required fields is implemented
10. Components can render with default values

## Tasks / Subtasks
- [x] Git Setup (REQUIRED FIRST TASK)
  - [x] Checkout and update main: `git checkout main && git pull premium main`
  - [x] Checkout epic branch: `git checkout epic/epic-9-sitemap-builder`
  - [x] Create story branch from epic: `git checkout -b story/9.2-global-components`
- [x] Create Premium Components Directory Structure (AC: 5)
  - [x] Create directory: `/lib/premium/components/globals/`
  - [x] Create subdirectory for each component: hero/, header/, footer/, cta/
  - [x] Verify directory structure is under premium path
- [x] Implement Hero Component (AC: 1, 8, 9, 10)
  - [x] Create `/lib/premium/components/globals/hero/types.ts` with HeroProps interface
  - [x] Create `/lib/premium/components/globals/hero/index.tsx`
  - [x] Create `/lib/premium/components/globals/hero/schema.ts` with metadata and validation function
  - [x] Create `/lib/premium/components/globals/hero/defaults.ts` with default values
  - [x] Implement basic render with title, subtitle, buttonText, buttonUrl
  - [x] Add validateHero function in schema.ts for required title field
- [x] Implement Header Component (AC: 2, 8, 9, 10)
  - [x] Create `/lib/premium/components/globals/header/types.ts` with HeaderProps interface
  - [x] Create `/lib/premium/components/globals/header/index.tsx`
  - [x] Create `/lib/premium/components/globals/header/schema.ts` with metadata and validation function
  - [x] Create `/lib/premium/components/globals/header/defaults.ts` with default values
  - [x] Implement basic render with logo, menuItems, ctaButton, sticky
  - [x] Add validateHeader function in schema.ts for required logo field
- [x] Implement Footer Component (AC: 3, 8, 9, 10)
  - [x] Create `/lib/premium/components/globals/footer/types.ts` with FooterProps interface
  - [x] Create `/lib/premium/components/globals/footer/index.tsx`
  - [x] Create `/lib/premium/components/globals/footer/schema.ts` with metadata and validation function
  - [x] Create `/lib/premium/components/globals/footer/defaults.ts` with default values
  - [x] Implement basic render with columns, copyright, socialLinks
  - [x] Add validateFooter function in schema.ts (always returns true - no required fields)
- [x] Implement CTA Component (AC: 4, 8, 9, 10)
  - [x] Create `/lib/premium/components/globals/cta/types.ts` with CTAProps interface
  - [x] Create `/lib/premium/components/globals/cta/index.tsx`
  - [x] Create `/lib/premium/components/globals/cta/schema.ts` with metadata and validation function
  - [x] Create `/lib/premium/components/globals/cta/defaults.ts` with default values
  - [x] Implement basic render with headline, subheadline, primaryButton, secondaryButton
  - [x] Add validateCTA function in schema.ts for required button text field
- [x] Create Component Registry (AC: 6, 7)
  - [x] Create `/lib/premium/utils/component-registry.ts`
  - [x] Define registry structure with all 4 components
  - [x] Export component metadata for discovery
  - [x] Include validation functions in registry
- [x] Test Component Rendering (AC: 10)
  - [x] Create simple test file to verify each component renders
  - [x] Test that default values work correctly
  - [x] Test validation for required fields
  - [x] Verify TypeScript types are working
- [x] Submit PR (REQUIRED FINAL TASK)
  - [x] Push branch: `git push -u premium story/9.2-global-components`
  - [x] Create PR from story branch → epic/epic-9-sitemap-builder branch
  - [x] PR Title: "feat(9.2): implement global components for sitemap builder"
  - [x] Link PR to story in description
  - [x] Include screenshots of rendered components in PR

## Dev Notes

### GitFlow Workflow
**CRITICAL: Follow GitFlow strictly for this story**

Branch Name: story/9.2-global-components
Base Branch: epic/epic-9-sitemap-builder
PR Target: epic/epic-9-sitemap-builder

Git Commands:
1. Setup: `git checkout main && git pull premium main`
2. Checkout epic: `git checkout epic/epic-9-sitemap-builder`
3. Create story branch from epic: `git checkout -b story/9.2-global-components`
4. Commit: Use conventional commits (feat:, fix:, docs:, etc.)
5. Push: `git push -u premium story/9.2-global-components`
6. PR: Create PR to epic/epic-9-sitemap-builder branch with title "feat(9.2): implement global components for sitemap builder"

### Premium Feature Placement Requirements
[Source: epic9-brownfield-prd.md#component-architecture]

**CRITICAL**: All components MUST be placed under `/lib/premium/` folders:
```
✅ CORRECT Premium Locations:
/lib/premium/components/globals/       # Global components location
  ├── hero/                            # Hero component
  │   ├── index.tsx                   # Component implementation
  │   ├── schema.ts                   # Metadata and validation
  │   └── defaults.ts                 # Default values
  ├── header/                          # Header component
  ├── footer/                          # Footer component
  └── cta/                            # CTA component

❌ FORBIDDEN Locations (will leak to open-source):
/components/globals/                   # WRONG - Common components
/lib/components/                       # WRONG - Not under premium
```

### Component Schema Structure (MVP)
[Source: epic9-brownfield-prd.md#component-metadata-architecture]

Each component needs basic metadata for identification and default rendering:
- **name**: Component display name (e.g., "Hero Section")
- **description**: Brief description of component purpose
- **properties**: Simple property definitions with:
  - **type**: Data type (string, number, boolean)
  - **required**: Whether property is mandatory
  - **default**: Default value if not provided

### Component Specifications
[Source: epic9-brownfield-prd.md#initial-component-set]

1. **Hero Component**
   - Default title: "Welcome"
   - Default subtitle: "Your journey starts here"
   - Default buttonText: "Get Started"
   - Default buttonUrl: "/signup"
   - Validation: Title must not be empty

2. **Header Component**
   - Default logo: "Company"
   - Default menuItems: [{label: "Home", url: "/"}, {label: "About", url: "/about"}, {label: "Contact", url: "/contact"}]
   - Default sticky: false
   - Validation: Logo must not be empty

3. **Footer Component**
   - Default copyright: "© 2024"
   - Default columns: []
   - Default socialLinks: []
   - Validation: Always valid (no required fields)

4. **CTA Component**
   - Default headline: "Ready?"
   - Default subheadline: "Start your journey today"
   - Default primaryButton: {text: "Get Started", url: "/signup"}
   - Validation: Button text must not be empty

### Component Storage Format
[Source: epic9-brownfield-prd.md#component-storage-in-database]

Components will be stored as JSON in ContentItem.content field:
```json
{
  "components": [
    {
      "type": "hero",
      "id": "unique-id",
      "props": {
        "title": "Welcome to Our Platform",
        "subtitle": "Custom subtitle text"
      }
    }
  ]
}
```

### Testing Standards
[Source: epic9-brownfield-architecture.md#testing-strategy]

**Component Testing Requirements**:
- Test file location: Create test files alongside components (e.g., `/lib/premium/components/globals/hero/hero.test.tsx`)
- Testing framework: Use existing Jest/React Testing Library setup
- Test standards:
  - Each component must render with default values
  - Validation functions must be tested for both valid and invalid inputs
  - TypeScript types must compile without errors
  - No automated test suite required for MVP - manual testing is acceptable
  - Focus on critical path: component renders, validation works, defaults apply
- Testing approach for this story:
  - Create a simple test file to verify all 4 components render
  - Manually test in browser that components display correctly
  - Verify validation prevents invalid data
  - Ensure TypeScript compilation succeeds

### Implementation Details

**Component File Structure Example (Hero Component)**:
```typescript
// /lib/premium/components/globals/hero/types.ts
export interface HeroProps {
  title: string;
  subtitle?: string;
  buttonText?: string;
  buttonUrl?: string;
}

// /lib/premium/components/globals/hero/index.tsx
import React from 'react';
import { HeroProps } from './types';

export const Hero: React.FC<HeroProps> = ({ title, subtitle, buttonText, buttonUrl }) => {
  return (
    <div className="hero-section">
      <h1>{title}</h1>
      {subtitle && <p>{subtitle}</p>}
      {buttonText && (
        <a href={buttonUrl || '/signup'}>{buttonText}</a>
      )}
    </div>
  );
};

// /lib/premium/components/globals/hero/schema.ts
import { HeroProps } from './types';

export const heroSchema = {
  name: 'Hero Section',
  description: 'Prominent section with headline and call-to-action',
  properties: {
    title: { type: 'string', required: true },
    subtitle: { type: 'string', required: false },
    buttonText: { type: 'string', required: false },
    buttonUrl: { type: 'string', required: false }
  }
};

// Validation function is part of schema.ts
export const validateHero = (props: Partial<HeroProps>): boolean => {
  return !!props.title && props.title.trim().length > 0;
};

// /lib/premium/components/globals/hero/defaults.ts
import { HeroProps } from './types';

export const heroDefaults: HeroProps = {
  title: 'Welcome',
  subtitle: 'Your journey starts here',
  buttonText: 'Get Started',
  buttonUrl: '/signup'
};
```

**Component Registry Structure**:
```typescript
// /lib/premium/utils/component-registry.ts
import { Hero } from '../components/globals/hero';
import { heroSchema, validateHero } from '../components/globals/hero/schema';
import { heroDefaults } from '../components/globals/hero/defaults';
// Similar imports for header, footer, cta components

export const COMPONENT_REGISTRY = {
  hero: {
    component: Hero,
    schema: heroSchema,
    defaults: heroDefaults,
    validate: validateHero
  },
  header: {
    component: Header,
    schema: headerSchema,
    defaults: headerDefaults,
    validate: validateHeader
  },
  footer: {
    component: Footer,
    schema: footerSchema,
    defaults: footerDefaults,
    validate: validateFooter
  },
  cta: {
    component: CTA,
    schema: ctaSchema,
    defaults: ctaDefaults,
    validate: validateCTA
  }
};
```

**Import Path Examples for Premium Components**:
```typescript
// When using these components in other parts of the application:
import { COMPONENT_REGISTRY } from '@/lib/premium/utils/component-registry';
import { Hero } from '@/lib/premium/components/globals/hero';
import { HeroProps } from '@/lib/premium/components/globals/hero/types';

// Example usage in sitemap builder:
const heroComponent = COMPONENT_REGISTRY.hero;
const isValid = heroComponent.validate(props);
const defaultProps = heroComponent.defaults;
```

### Previous Story Insights
Story 9.1 successfully added the 'folder' enum to ContentTypeCategory. The database migration was completed and the Prisma client was regenerated. The epic branch `epic/epic-9-sitemap-builder` has been created and is ready for new story branches.

### Testing Standards
[Source: epic9-brownfield-architecture.md#testing-strategy]

**Component Testing Requirements**:
- Each component should render with default values
- Validation functions should be tested
- TypeScript types should compile without errors
- No automated tests required for MVP (manual testing acceptable)
- Focus on critical path testing

### Integration Points
These components will be used by:
- Sitemap builder UI (to show available components)
- Component registry (for discovery and validation)
- ContentItemService (for storing component assignments)
- PageOrchestrator (for rendering components on pages)

### Technical Constraints
- Use React 18+ features
- TypeScript 5+ for type safety
- Tailwind CSS for styling (minimal styling only - focus on structure not appearance)
- Keep components simple for MVP (no configuration UI)
- Focus on default values and basic validation
- **MVP Styling**: Components should have minimal or no styling, just basic structure
- **Component Exports**: Use named exports for all components (e.g., `export const Hero = ...`)
- **Props Interface Naming**: Use pattern `{ComponentName}Props` (e.g., `HeroProps`, `HeaderProps`)

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-08-25 | 1.0 | Initial story creation | Scrum Master |
| 2025-08-25 | 1.1 | Applied PO feedback: Added implementation details, styling guidance, export patterns | Scrum Master |
| 2025-08-25 | 1.2 | Fixed critical issues from PO validation: GitFlow consistency, added Testing Standards section, clarified TypeScript structure, validation locations, and import paths | Scrum Master |

## Dev Agent Record
### Agent Model Used
claude-opus-4-1-20250805

### Debug Log References
- Git setup completed successfully with story branch created from epic branch
- Premium directory structure created under /lib/premium/components/globals/
- All four global components implemented with TypeScript types, schemas, validation, and defaults
- Component registry created to centralize component discovery and metadata
- Components tested and verified to render with default values
- Validation functions tested for correct behavior

### Completion Notes List
- All components follow the exact structure specified in Dev Notes
- Used named exports for all components as required
- Props interfaces follow {ComponentName}Props naming pattern
- Minimal styling applied (just basic structure, no CSS styling)
- All components are in premium location to prevent leaking to open-source
- Component registry exports all metadata for discovery
- TypeScript compilation successful for all component files

### File List
- /lib/premium/components/globals/hero/types.ts
- /lib/premium/components/globals/hero/index.tsx
- /lib/premium/components/globals/hero/schema.ts
- /lib/premium/components/globals/hero/defaults.ts
- /lib/premium/components/globals/header/types.ts
- /lib/premium/components/globals/header/index.tsx
- /lib/premium/components/globals/header/schema.ts
- /lib/premium/components/globals/header/defaults.ts
- /lib/premium/components/globals/footer/types.ts
- /lib/premium/components/globals/footer/index.tsx
- /lib/premium/components/globals/footer/schema.ts
- /lib/premium/components/globals/footer/defaults.ts
- /lib/premium/components/globals/cta/types.ts
- /lib/premium/components/globals/cta/index.tsx
- /lib/premium/components/globals/cta/schema.ts
- /lib/premium/components/globals/cta/defaults.ts
- /lib/premium/utils/component-registry.ts
- /lib/premium/components/globals/test-components.tsx

## QA Results
[To be filled by QA Agent]